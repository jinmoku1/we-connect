<%- include partials/header.ejs %>

<div id="topContainer" class="row">
	<div class="col-md-3">
		<div id="pictureContainer">
			<div class="picture">
				<img src="http://www.hdwallpapers.in/walls/amanda_seyfried-normal5.4.jpg" />
			</div>
		</div>
	</div>
	<div id="profileContainer" class="col-md-9">
		<h1 class="name">
			<%=user.firstName%>
			<%=user.lastName%>
			<span class="email">
				<em><a href="mailto:<%=user.netId%>@illinois.edu"><%=user.netId%>@illinois.edu</a></em>
			</span>
		</h1>
		<p>
			<% if (user.userType == userConst.TYPE_STUDENT) { %>
				<em><%=user.extension.degree%> (<%=user.extension.classStanding%>) in <%=user.department%></em>
			<% } else {%>
				<em>Faculty in <%=user.department%></em>
			<% } %>
		</p>
		<p class="intro">
			<%=user.intro%>...
			<a data-toggle="modal" data-target="#fullIntroModal"><em>more</em></a>
		</p>
		<p class="interests">
			<% for (var i in user.interests) { %>
			<span class="label label-default"><%=user.interests[i]%></span>
			<% } %>
		</p>
		<div class="buttons">
			<a class="btn btn-lgray" data-toggle="modal" href="/embedded/followees" data-target="#followeesModal">
				Followees <span id="followeeCount" class="badge"><%=user.followees.length%></span>
			</a>
			<a class="btn btn-lgray" data-toggle="modal" href="/embedded/followings" data-target="#followingsModal">
				Followings <span class="badge"><%=user.followings.length%></span>
			</a>
		</div>
	</div>
</div>

<div id="bottomContainer" class="row">
	<div id="mainContainer" class="col-md-9">
	</div>
	<div id="sideContainer" class="col-md-3">
		<h3 class="header-side">Suggested Users</h3>
		<% for (var i in userBriefs) { %>
			<div class="user" id="<%=userBriefs[i].detailId%>">
				<div class="top row">
					<div class="col-md-4">
						<div class="picture">
						</div>
					</div>
					<div class="side col-md-8">
						<p class="name">
							<a data-toggle="modal" href="/embedded/profile/<%=userBriefs[i].detailId%>" data-target="#userProfileModal">
								<%=userBriefs[i].firstName%></br /><%=userBriefs[i].lastName%>
							</a>
						</p>
						<div class="email">
							<a href="mailto:<%=userBriefs[i].netId%>@illinois.edu">
								<em><%=userBriefs[i].netId%>@illinois.edu</a>
							</em>
						</div>
					</div>
				</div>
				<div class="interests">
					<span class="label label-info">Software Engineering</span>
					<span class="label label-info">Data Mining</span>
					<span class="label label-info">Computer Architecture</span>
					<span class="label label-info">Database</span>
				</div>
			</div>
		<% } %>
	</div>
</div>

<!-- Full Intro Modal -->
<div class="modal fade" id="fullIntroModal" tabindex="-1" role="dialog" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				<h4 class="modal-title" id="myModalLabel">Introduction</h4>
			</div>
			<div class="modal-body">
				<p><%=user.intro%></p> 
			</div>
		</div>
	</div>
</div>

<!-- User Profile Modal -->
<div class="modal fade" id="userProfileModal" tabindex="-1" role="dialog" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
		</div>
	</div>
</div>

<!-- Followees Modal -->
<div class="modal fade" id="followeesModal" tabindex="-1" role="dialog" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
		</div>
	</div>
</div>

<!-- Followings Modal -->
<div class="modal fade" id="followingsModal" tabindex="-1" role="dialog" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
		</div>
	</div>
</div>

<!-- User Followee list modal -->
<div class="modal fade" id="userFolloweeListModal" tabindex="-1" role="dialog" aria-labelledby="userFolloweeListModal" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
		</div>
	</div>
</div>

<script>
function onToggleFollow(targetId) {
	$.post('/api/follow', { id : targetId }, function(sessionUser) {
		$('#followeeCount').html(sessionUser.followees.length);
		$('#' + targetId).fadeOut('fast');
		$('.modal').modal('hide');
	});
}

$('a[data-toggle=modal]').click(function(event) {
	event.preventDefault();
	var url = $(this).attr('href');
	var target = $(this).data('target');
	// load the url and show modal on success
	$(target + ' .modal-content').load(url, function() { 
		$(target).modal('show');
	});
});
</script>

<%- include partials/footer.ejs %>